{% extends 'student/studentbase.html' %}
{% load widget_tweaks %}

{% block title %}Dashboard - Student Portal{% endblock %}
{% block page_title %}Student Dashboard{% endblock %}
{% block breadcrumb %}Dashboard{% endblock %}

{% block content %}
<div class="space-y-6">
  <!-- Welcome Section -->
  <div class="gradient-bg rounded-2xl p-8 text-white relative overflow-hidden">
    <div class="relative z-10">
      <h2 class="text-3xl font-bold mb-2">Welcome back, {{request.user.first_name}}!</h2>
      <p class="text-lg opacity-90 mb-6">Ready to take some exams? Let's continue your learning journey!</p>
      
      <div class="flex flex-wrap gap-4">
        <a href="/student/student-exam" class="bg-white bg-opacity-20 hover:bg-opacity-30 px-6 py-3 rounded-lg font-semibold transition-all duration-300 hover:transform hover:scale-105">
          <i class="fas fa-book mr-2"></i>
          Browse Courses
        </a>
        <a href="/student/student-marks" class="border-2 border-white border-opacity-50 hover:bg-white hover:text-blue-600 px-6 py-3 rounded-lg font-semibold transition-all duration-300">
          <i class="fas fa-chart-line mr-2"></i>
          View Results
        </a>
      </div>
    </div>
    
    <!-- Background decoration -->
    <div class="absolute -right-10 -top-10 w-40 h-40 bg-white bg-opacity-10 rounded-full"></div>
    <div class="absolute -right-5 -bottom-5 w-24 h-24 bg-white bg-opacity-10 rounded-full"></div>
    <div class="absolute -left-10 top-1/2 w-16 h-16 bg-white bg-opacity-10 rounded-full"></div>
  </div>

  <!-- Quick Stats -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <!-- Available Courses -->
    <div class="bg-white rounded-xl p-6 shadow-lg card-hover border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-blue-50 rounded-lg">
          <i class="fas fa-book text-2xl text-blue-500"></i>
        </div>
        <span class="text-3xl font-bold text-gray-800">{{ total_course|default:"0" }}</span>
      </div>
      <h3 class="font-semibold text-gray-800 mb-1">Available Courses</h3>
      <p class="text-sm text-gray-600">Courses you can take</p>
    </div>

    <!-- Exams Taken -->
    <div class="bg-white rounded-xl p-6 shadow-lg card-hover border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-green-50 rounded-lg">
          <i class="fas fa-check-circle text-2xl text-green-500"></i>
        </div>
        <span class="text-3xl font-bold text-gray-800">{{ exams_taken|default:"0" }}</span>
      </div>
      <h3 class="font-semibold text-gray-800 mb-1">Exams Taken</h3>
      <p class="text-sm text-gray-600">Total attempts</p>
    </div>

    <!-- Average Score -->
    <div class="bg-white rounded-xl p-6 shadow-lg card-hover border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-purple-50 rounded-lg">
          <i class="fas fa-star text-2xl text-purple-500"></i>
        </div>
        <span class="text-3xl font-bold text-gray-800">{{ average_score|default:"--" }}%</span>
      </div>
      <h3 class="font-semibold text-gray-800 mb-1">Average Score</h3>
      <p class="text-sm text-gray-600">Overall performance</p>
    </div>

    <!-- Last Score -->
    <div class="bg-white rounded-xl p-6 shadow-lg card-hover border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <div class="p-3 bg-orange-50 rounded-lg">
          <i class="fas fa-trophy text-2xl text-orange-500"></i>
        </div>
        <span class="text-3xl font-bold text-gray-800">{{ last_score|default:"--" }}%</span>
      </div>
      <h3 class="font-semibold text-gray-800 mb-1">Latest Score</h3>
      <p class="text-sm text-gray-600">Most recent exam</p>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    
    <!-- Available Courses -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100">
      <div class="p-6 border-b border-gray-200">
        <h3 class="text-xl font-bold text-gray-800 flex items-center">
          <i class="fas fa-book mr-3 text-blue-500"></i>
          Available Courses
        </h3>
      </div>
      <div class="p-6">
        <div class="space-y-4">
          <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="font-semibold text-gray-800">Mathematics Advanced</h4>
                <p class="text-sm text-gray-600">50 questions • 100 marks</p>
              </div>
              <a href="/student/student-exam" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                Take Exam
              </a>
            </div>
          </div>
          
          <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="font-semibold text-gray-800">Physics Fundamentals</h4>
                <p class="text-sm text-gray-600">40 questions • 80 marks</p>
              </div>
              <a href="/student/student-exam" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                Take Exam
              </a>
            </div>
          </div>
          
          <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors">
            <div class="flex items-center justify-between">
              <div>
                <h4 class="font-semibold text-gray-800">Chemistry Basics</h4>
                <p class="text-sm text-gray-600">30 questions • 60 marks</p>
              </div>
              <a href="/student/student-exam" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                Take Exam
              </a>
            </div>
          </div>
        </div>
        
        <div class="mt-6 text-center">
          <a href="/student/student-exam" class="text-blue-600 hover:text-blue-700 font-medium">
            View All Courses →
          </a>
        </div>
      </div>
    </div>

    <!-- Recent Results -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100">
      <div class="p-6 border-b border-gray-200">
        <h3 class="text-xl font-bold text-gray-800 flex items-center">
          <i class="fas fa-chart-bar mr-3 text-green-500"></i>
          Recent Results
        </h3>
      </div>
      <div class="p-6">
        <div class="space-y-4">
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <h4 class="font-semibold text-gray-800">Mathematics Advanced</h4>
              <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                94 / 100
              </span>
            </div>
            <div class="flex items-center justify-between text-sm text-gray-600">
              <span>Nov 15, 2024</span>
              <span>94.0%</span>
            </div>
          </div>
          
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <h4 class="font-semibold text-gray-800">Physics Fundamentals</h4>
              <span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium">
                70 / 80
              </span>
            </div>
            <div class="flex items-center justify-between text-sm text-gray-600">
              <span>Nov 12, 2024</span>
              <span>87.5%</span>
            </div>
          </div>
          
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <h4 class="font-semibold text-gray-800">Chemistry Basics</h4>
              <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                55 / 60
              </span>
            </div>
            <div class="flex items-center justify-between text-sm text-gray-600">
              <span>Nov 10, 2024</span>
              <span>91.7%</span>
            </div>
          </div>
        </div>
        
        <div class="mt-6 text-center">
          <a href="/student/student-marks" class="text-green-600 hover:text-green-700 font-medium">
            View All Results →
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="bg-white rounded-xl shadow-lg border border-gray-100">
    <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-800 flex items-center">
        <i class="fas fa-bolt mr-3 text-orange-500"></i>
        Quick Actions
      </h3>
    </div>
    <div class="p-6">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        
        <a href="/student/student-exam" class="flex items-center space-x-3 p-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-300 hover:transform hover:scale-105">
          <i class="fas fa-book"></i>
          <span class="font-medium">Browse All Courses</span>
        </a>
        
        <a href="/student/student-marks" class="flex items-center space-x-3 p-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-300 hover:transform hover:scale-105">
          <i class="fas fa-chart-line"></i>
          <span class="font-medium">View All Results</span>
        </a>
        
        <button onclick="showProfile()" class="flex items-center space-x-3 p-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg hover:from-purple-600 hover:to-purple-700 transition-all duration-300 hover:transform hover:scale-105">
          <i class="fas fa-user"></i>
          <span class="font-medium">My Profile</span>
        </button>
      </div>
    </div>
  </div>

  <!-- How to Take Exams Guide -->
  <div class="bg-white rounded-xl shadow-lg border border-gray-100">
    <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-800 flex items-center">
        <i class="fas fa-question-circle mr-3 text-indigo-500"></i>
        How to Take Exams
      </h3>
    </div>
    <div class="p-6">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="text-center">
          <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <span class="text-xl font-bold text-blue-600">1</span>
          </div>
          <h4 class="font-semibold text-gray-800 mb-2">Choose Course</h4>
          <p class="text-sm text-gray-600">Browse available courses and select one to take</p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <span class="text-xl font-bold text-green-600">2</span>
          </div>
          <h4 class="font-semibold text-gray-800 mb-2">Answer Questions</h4>
          <p class="text-sm text-gray-600">Answer multiple choice questions within the time limit</p>
        </div>

        <div class="text-center">
          <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <span class="text-xl font-bold text-purple-600">3</span>
          </div>
          <h4 class="font-semibold text-gray-800 mb-2">Get Results</h4>
          <p class="text-sm text-gray-600">View your score immediately after completing the exam</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Show profile function
  function showProfile() {
    showNotification('Profile management coming soon!', 'info');
  }

  // Animation on page load
  document.addEventListener('DOMContentLoaded', function() {
    // Animate stats on load
    const statNumbers = document.querySelectorAll('.text-3xl.font-bold');
    statNumbers.forEach(stat => {
      const text = stat.textContent;
      const numberMatch = text.match(/\d+/);
      
      if (numberMatch) {
        const finalNumber = parseInt(numberMatch[0]);
        let currentNumber = 0;
        const increment = finalNumber / 30;
        
        const counter = setInterval(() => {
          currentNumber += increment;
          if (currentNumber >= finalNumber) {
            stat.textContent = text; // Restore original text with %
            clearInterval(counter);
          } else {
            stat.textContent = text.replace(/\d+/, Math.floor(currentNumber));
          }
        }, 50);
      }
    });

    // Animate cards
    const cards = document.querySelectorAll('.card-hover');
    cards.forEach((card, index) => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      
      setTimeout(() => {
        card.style.transition = 'all 0.5s ease';
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
      }, index * 100);
    });
  });
</script>
{% endblock content %}